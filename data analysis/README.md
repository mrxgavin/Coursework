# åŠ¨æ¼«ã€Šå·¥ä½œç»†èƒã€‹è¯„è®ºåˆ†æåŠBilibiliç”¨æˆ·è¯„è®ºçˆ¬å–  
### ç»¼åˆå®éªŒæœŸæœ«ä½œä¸š  å¾å­åº·
## ğŸ”° çˆ¬å–

é¦–å…ˆçˆ¬å–Bilibiliä¸Šï¼ŒåŠ¨ä½œç»†èƒç•ªå‰§ä¸‹çš„è¯„è®ºã€‚æ‰¾åˆ°å¯¹åº”Jsonæ–‡ä»¶ï¼Œç„¶åè·å–Jsonä¸­çš„æ•°æ®ã€‚  
![](pic/1.png)
ç‚¹å¼€é“¾æ¥åå‘ç°æ˜¯å‰20æ¡è®°å½•ï¼Œæ ¼å¼æ˜¯jsonä¸”æ˜¯æˆ‘ä»¬éœ€è¦çš„å†…å®¹ã€‚è·å–æ¥ä¸‹æ¥20æ¡è¯„è®ºã€‚å‘ç°è¿™äº›jsonæ–‡ä»¶çš„è·¯å¾„å­˜åœ¨è§„å¾‹ã€‚  
![](pic/2.png)

â€‹```
import requests
from fake_useragent import UserAgent
import json
import pandas as pd
import time
import datetime
headers = { "User-Agent": UserAgent(verify_ssl=False).random}
comment_api = 'https://bangumi.bilibili.com/review/web_api/short/list?media_id=102392&folded=0&page_size=20&sort=0'ã€‘
â€‹```

æ‰€æœ‰çš„jsonè·¯å¾„çš„å‰åŠéƒ¨åˆ†éƒ½æ˜¯ä¸€æ ·ï¼Œéƒ½æ˜¯å†ç¬¬ä¸€æ¡jsonä¹‹ååŠ ä¸Šä¸åŒçš„cursor = xxxï¼Œæ‰€ä»¥åªè¦æ‰¾åˆ°cursorå€¼å¾—è§„å¾‹ï¼Œå°±å¯ä»¥ç”¨å¾ªç¯çš„åŠæ³•ï¼Œçˆ¬å®Œæ‰€æœ‰jsonã€‚æœ€åå‘ç°ï¼Œæ¯ä¸€ä¸ªjsonè·¯å¾„ä¸­cursorå€¼å°±è—åœ¨å‰ä¸€ä¸ªjsonçš„æœ€åä¸€æ¡è¯„è®ºä¸­ã€‚  
![](pic/3.png)
æ‰€ä»¥ä¸»è¦æ€è·¯å°±æ˜¯ä»ç¬¬ä¸€ä¸ªjsonå¼€å§‹ï¼Œçˆ¬å–å®Œ20æ¡è¯„è®ºåï¼Œè·å–æœ€åä¸€ä¸ªè¯„è®ºä¸­çš„cursorå€¼ï¼Œæ›´æ”¹å¦‚ä»Šä¹‹åè·å–ç¬¬äºŒä¸ªjsonï¼Œé‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œç›´åˆ°çˆ¬å®Œæ‰€æœ‰çš„jsonã€‚ 
``` 
j = 0
while j <total:
    n = len(json_comment['result']['list'])
    for i in range(n):
        dataall.loc[j,'author'] = json_comment['result']['list'][i]['author']['uname']
        dataall.loc[j,'score'] = json_comment['result']['list'][i]['user_rating']['score']
        dataall.loc[j,'disliked'] = json_comment['result']['list'][i]['disliked']
        dataall.loc[j,'likes'] = json_comment['result']['list'][i]['likes']
        dataall.loc[j,'liked'] = json_comment['result']['list'][i]['liked']
        dataall.loc[j,'ctime'] = json_comment['result']['list'][i]['ctime']
        dataall.loc[j,'content'] = json_comment['result']['list'][i]['content']
        dataall.loc[j,'cursor'] = json_comment['result']['list'][n-1]['cursor'] 
        j+= 1
    try:        
        dataall.loc[j,'last_ep_index'] = json_comment['result']['list'][i]['user_season']['last_ep_index']
    except:
        pass

    comment_api1 = comment_api + '&cursor=' + dataall.loc[j-1,'cursor'] 
    response_comment = requests.get(comment_api1,headers = headers)
    json_comment = response_comment.text
    json_comment = json.loads(json_comment)
    
    if j % 50 ==0:
        print('å·²å®Œæˆ {}% !'.format(round(j/total*100,2)))
    time.sleep(0.5)
```

### âœ¨çˆ¬å–å®Œåæ•°æ®é¢„è§ˆå¦‚ä¸‹ã€‚  
![](pic/4.png)
authorè¡¨ç¤ºè¯„è®ºå‘è¡¨çš„ç”¨æˆ·åï¼Œscoreè¡¨ç¤ºæ‰“åˆ†ï¼Œlikesè¡¨ç¤ºç‚¹èµï¼Œctimesè¡¨ç¤ºæ—¶é—´ï¼Œcontentè¡¨ç¤ºè¯„è®ºå†…å®¹ã€‚  

## ğŸ”° æ•°æ®åˆ†æ

### âœ¨ç”¨æˆ·è¯„åˆ†
ä¸€å…±çˆ¬å–åˆ°äº†1.9ä¸‡æ¡è¯„è®ºã€‚é¦–å…ˆå¯¹ç”¨æˆ·çš„æ‰“åˆ†è¿›è¡Œåˆ†æã€‚scoreå–å€¼èŒƒå›´ä¸º2ï¼Œ4ï¼Œ6ï¼Œ8ï¼Œ10åˆ†ï¼Œåˆ†åˆ«å¯¹åº”1-5é¢—æ˜Ÿã€‚  
![](pic/5.png)
å¦‚è¡¨æ‰€ç¤ºï¼Œå‡ ä¹æ‰€æœ‰çš„ç”¨æˆ·éƒ½ç»™äº†è¿™éƒ¨åŠ¨æ¼«äº”æ˜Ÿå¥½è¯„  

### âœ¨è¯„è®ºæ•°æ—¶é—´åˆ†å¸ƒ
![](pic/6.png)
ç»Ÿè®¡äº†æ¯ä¸€å¤©çš„è¯„è®ºæœ¯åï¼Œå¾—åˆ°äº†è¯„è®ºæ•°çš„åˆ†å¸ƒå›¾ã€‚å¯ä»¥çœ‹åˆ°è¯„è®ºä¸»è¦é›†ä¸­åœ¨æ¯ä¸€æ¬¡åŠ¨æ¼«æ›´æ–°çš„æ—¶é—´ç‚¹ä¸Šã€‚

### âœ¨ä¸€å¤©ä¹‹å†…çš„è¯„è®ºæ—¶é—´åˆ†å¸ƒ
![](pic/7.png)
é™¤äº†æ¯æ—¥çš„è¯„è®ºæ•°ã€‚é€šè¿‡å¯¹ç”¨æˆ·çš„è¯„è®ºæ—¶é—´è¿›è¡Œç»Ÿè®¡åˆ†æã€‚å¯ä»¥çœ‹åˆ°ä¸­åˆåˆ°æ™šä¸Šå…·æœ‰ä¸Šå‡è¶‹åŠ¿ã€‚ä»¥åŠå‡Œæ™¨ä¸‰ç‚¹å¼€å§‹è¯„è®ºæ•°ä¸Šæ¶¨ã€‚å¯èƒ½å¯ä»¥è¯´æ˜ä¸€éƒ¨åˆ†çœ‹è¿™ä¸ªåŠ¨æ¼«çš„ç”¨æˆ·æœ‰æ™šç¡çš„ä¹ æƒ¯ã€‚

### âœ¨çƒ­è¯„å­—æ•°
![](pic/8.png)
åŒæ—¶æˆ‘è¿˜æƒ³åˆ†æä¸€äº›ï¼Œæ˜¯å¦ç‚¹èµå¤šçš„ï¼Œä¸€å®šæ˜¯å†™çš„è¯„è®ºçš„å­—æ•°å¤šçš„ã€‚å› ä¸ºå¤§éƒ¨åˆ†è¯„è®ºæ²¡æœ‰ç‚¹èµï¼Œæ‰€ä»¥è¿™é‡Œåªç»Ÿè®¡äº†æœ‰ç‚¹èµçš„ã€‚æ•´ä½“çœ‹æ¥ï¼Œå­—æ•°å’Œç‚¹èµæ•°æ²¡ä»€ä¹ˆå…³ç³»ã€‚

### âœ¨è¯„è®ºåˆ†æTF-IDF
æ¥ä¸‹æ¥å¯¹è¯„è®ºå†…å®¹è¿›è¡Œåˆ†æã€‚çœ‹çœ‹å¤§å®¶éƒ½è¯´äº†ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¿™éƒ¨å‰§é‚£ä¹ˆå—æ¬¢è¿ã€‚  
é€šè¿‡jiebaåˆ†è¯ï¼›å»é™¤åœæ­¢è¯ï¼Œè®¡ç®—è¯é¢‘å’ŒTF-IDFçš„è¿‡ç¨‹ï¼Œæå–äº†é‡è¦æ€§å‰500çš„è¯ã€‚  
![](pic/9.png)  
å¯ä»¥çœ‹åˆ°ï¼Œâ€œè¡€å°æ¿â€é«˜å±…é¦–ä½ï¼Œæ¯•ç«Ÿå¤§å®¶å¯¹äºè¿™ä¸ªé‡è¦çš„è§’è‰²å¾ˆæ˜¯å–œæ¬¢ã€‚è¯è¯­ä¸­ä¹Ÿå­˜åœ¨ä¸€äº›æ„ä¹‰ä¸å¤§çš„è¯ã€‚ä¸è¿‡ä»è¿™äº›è¯äº‘ä¸­è¿˜æ˜¯å¯ä»¥çœ‹å‡ºå¾ˆå¤šä¸œè¥¿ã€‚æ¯”å¦‚é¢˜æçš„é€‰å–ï¼ŒåŠ¨æ¼«çš„å¯çˆ±ç”»é£ã€‚
![è¯äº‘](pic/640.png)
